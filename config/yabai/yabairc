yabai -m signal --add event=dock_did_restart action="sudo yabai --load-sa"
sudo yabai --load-sa

#osascript -e 'tell application id "tracesOf.Uebersicht" to refresh'

# global settings
yabai -m config \
    window_shadow float \
    window_animation_frame_rate 120 \
    window_opacity off \
    window_border off \
    window_border_width 4 \
    active_window_border_color 0xff775759 \
    normal_window_border_color 0xff555555 \
    insert_feedback_color 0xffd75f5f \
    layout stack \
    top_padding 18 \
    bottom_padding 18 \
    left_padding 18 \
    right_padding 18 \
    window_gap 18 \
    mouse_modifier ctrl \
    mouse_drop_action stack \
    external_bar all:0:0


# space settings
yabai -m space 1  --label tty
yabai -m space 2  --label www
yabai -m space 3  --label dev
yabai -m space 4  --label write
yabai -m space 5  --label misc --layout float
yabai -m space 6  --label chat
yabai -m space 7  --label utils
yabai -m space 8  --label other
yabai -m space 9  --label alt
yabai -m space 10 --label music

# rules for capture
yabai -m rule --add app="^Finder$" manage=off
yabai -m rule --add app="^1Password$" manage=off
yabai -m rule --add app="^The Unarchiver$" manage=off
yabai -m rule --add app="^App Store$" manage=off

yabai -m rule --add app="^System Settings$" manage=off
yabai -m rule --add app="^System Information$" manage=off
yabai -m rule --add app="^Activity Monitor$" manage=off
yabai -m rule --add app="^Raycast Settings$" manage=off

yabai -m rule --add app="^Mail$" manage=off space=misc

yabai -m rule --add app="^Messages$" space=chat
yabai -m rule --add app="^Telegram$" space=chat
yabai -m rule --add app="^WhatsApp$" space=chat
yabai -m rule --add app="^Discord$" space=chat

yabai -m rule --add app="^Firefox$" space=www
yabai -m rule --add app="^Arc$" space=www
yabai -m rule --add app="^Zen$" space=www
yabai -m rule --add app="^Safari$" space=www
yabai -m rule --add app="^Chromium$" space=other
yabai -m rule --add app="^Brave$" space=other
yabai -m rule --add app="^Spotify$" space=music
yabai -m rule --add app="^Craft$" space=write
yabai -m rule --add app="^Obsidian$" space=write

yabai -m rule --add app="^Ghostty$" space=tty
yabai -m rule --add app="^Zed$" space=dev

yabai -m signal --add app='^Ghostty$' event=window_created action='yabai -m space --layout bsp'
yabai -m signal --add app='^Ghostty$' event=window_destroyed action='yabai -m space --layout bsp'


## sketchybar
# yabai -m signal --add event=window_focused action="sketchybar --trigger window_focus"
# yabai -m signal --add event=window_created action="sketchybar --trigger windows_on_spaces"
# yabai -m signal --add event=window_destroyed action="sketchybar --trigger windows_on_spaces"

## simple-bar
yabai -m signal --add event=space_changed \
  action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-index-jsx\"'" label="Refresh simple-bar on space change"
yabai -m signal --add event=display_changed \
  action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-index-jsx\"'" label="Refresh simple-bar on display focus change"
yabai -m signal --add event=window_focused \
  action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-index-jsx\"'" label="Refresh simple-bar when focused application changes"
yabai -m signal --add event=window_resized \
  action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-index-jsx\"'" label="Refresh simple-bar when a window is resized"
yabai -m signal --add event=application_front_switched \
  action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-index-jsx\"'" label="Refresh simple-bar when front application switched application changes"
yabai -m signal --add event=window_destroyed \
  action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-index-jsx\"'" label="Refresh simple-bar when an application window is closed"
yabai -m signal --add event=window_title_changed \
  action="osascript -e 'tell application id \"tracesOf.Uebersicht\" to refresh widget id \"simple-bar-index-jsx\"'" label="Refresh simple-bar when current window title changes"


set +x
echo "yabai configuration loaded.."
